create table room (rno int, cap int);
create table revent (reid int, reg int);
create table sevent (seid int, reg int);
create table schedule(rno int, eid int);

insert into room values(101,15);
insert into room values(102,30);
insert into room values(110,2);
insert into room values(210,50);
insert into room values(220,10);
insert into room values(223,90);
insert into room values(330,200);
insert into room values(101,15);

insert into revent values(10, 30);
insert into revent  values(11, 40);
insert into revent  values(12, 30);
insert into revent  values(13, 30);
insert into revent  values(20, 30);
insert into revent  values(21, 30);
insert into revent  values(22, 30);

insert into sevent  values(51, 180);
insert into sevent  values(52, 190);
insert into sevent  values(53, 110);
insert into sevent  values(54, 60);

insert into schedule values(330, 51);
insert into schedule values(102, 10);
insert into schedule values(210, 10);
insert into schedule values(102, 10);
insert into schedule values(223, 10);
insert into schedule values(330, 52);
insert into schedule values(102, 10);
insert into schedule values(210, 13);
insert into schedule values(102, 12);
insert into schedule values(102, 54);
insert into schedule values(330, 12);
insert into schedule values(101, 12);

select sch.rno, se.reg, re.reg, se.reg+re.reg "sum"
from schedule sch, sevent se, revent re, room r
where (sch.eid = se.seid or sch.eid = re.reid) and (sch.rno = r.rno)


select tb.rno, avg(tb.registers)
from (
select sch.rno, r.cap, sch.eid, rev.reid "eventId", rev.reg "registers"
from schedule sch, room r, revent rev
where sch.rno = r.rno and sch.eid = rev.reid
union all
select sch.rno, r.cap, sch.eid,  sev.seid "eventId", sev.reg "registers"
from schedule sch, room r,  sevent sev
where sch.rno = r.rno and  sch.eid = sev.seid) tb
group by tb.rno
order by tb.rno


